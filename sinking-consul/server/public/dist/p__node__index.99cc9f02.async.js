"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[706],{64042:function(se,A,u){u.r(A),u.d(A,{default:function(){return _}});var L=u(15009),c=u.n(L),P=u(99289),R=u.n(P),z=u(5574),g=u.n(z),j=u(67294),S=u(55404),K=u(63385),G=u(25336),C=u(41728);function V(){return T.apply(this,arguments)}function T(){return T=R()(c()().mark(function f(){var e,l=arguments;return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=l.length>0&&l[0]!==void 0?l[0]:{},a.abrupt("return",(0,C.U2)("/admin/node/list",e==null?void 0:e.body,e==null?void 0:e.onSuccess,e==null?void 0:e.onFail,e==null?void 0:e.onFinally));case 2:case"end":return a.stop()}},f)})),T.apply(this,arguments)}function Q(){return E.apply(this,arguments)}function E(){return E=R()(c()().mark(function f(){var e,l=arguments;return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=l.length>0&&l[0]!==void 0?l[0]:{},a.abrupt("return",(0,C.v_)("/admin/node/update",e==null?void 0:e.body,e==null?void 0:e.onSuccess,e==null?void 0:e.onFail,e==null?void 0:e.onFinally));case 2:case"end":return a.stop()}},f)})),E.apply(this,arguments)}function U(){return I.apply(this,arguments)}function I(){return I=R()(c()().mark(function f(){var e,l=arguments;return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=l.length>0&&l[0]!==void 0?l[0]:{},a.abrupt("return",(0,C.v_)("/admin/node/delete",e==null?void 0:e.body,e==null?void 0:e.onSuccess,e==null?void 0:e.onFail,e==null?void 0:e.onFinally));case 2:case"end":return a.stop()}},f)})),I.apply(this,arguments)}var J=u(34484),W=u(36447),k=u(59586),X=u(85418),w=u(83622),q=u(13573),i=u(85893),_=function(){var f,e,l,Y=(0,G.ws)(["node"]),a=g()(Y,1),p=a[0],B=W.Z.useApp(),s=B.message,ee=B.modal,b=(0,j.useRef)({}),ne=k.Z.useForm(),te=g()(ne,1),m=te[0],re=(0,j.useState)([]),O=g()(re,2),ue=O[0],Z=O[1],ae=(0,j.useState)(!1),H=g()(ae,2),le=H[0],M=H[1],oe=function(){var o=R()(c()().mark(function n(t){var r;return c()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return M(!0),D.next=3,Q({body:{addresses:ue,status:t==null||(r=t.status)===null||r===void 0?void 0:r.toString()},onSuccess:function(h){var v,y,F;(v=b.current)===null||v===void 0||v.hide(),(y=d.current)===null||y===void 0||y.refreshTableData(),(F=d.current)===null||F===void 0||F.clearSelectedRows(),s==null||s.success((h==null?void 0:h.message)||"\u7F16\u8F91\u6210\u529F")},onFail:function(h){s==null||s.error((h==null?void 0:h.message)||"\u8BF7\u6C42\u5931\u8D25")}});case 3:M(!1);case 4:case"end":return D.stop()}},n)}));return function(t){return o.apply(this,arguments)}}(),N=function(n){ee.confirm({title:"\u5220\u9664\u8282\u70B9",content:"\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684 ".concat((n==null?void 0:n.length)||0," \u4E2A\u8282\u70B9\u5417\uFF1F"),okText:"\u786E \u5B9A",okType:"danger",cancelText:"\u53D6 \u6D88",maskClosable:!0,onOk:function(){var t=R()(c()().mark(function x(){return c()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,U({body:{addresses:n},onSuccess:function(v){var y,F;(y=d.current)===null||y===void 0||y.refreshTableData(),(F=d.current)===null||F===void 0||F.clearSelectedRows(),s==null||s.success((v==null?void 0:v.message)||"\u5220\u9664\u6210\u529F")},onFail:function(v){s==null||s.error((v==null?void 0:v.message)||"\u8BF7\u6C42\u5931\u8D25")}});case 2:case"end":return $.stop()}},x)}));function r(){return t.apply(this,arguments)}return r}()})},d=j.useRef(null),ie=[{title:"\u670D\u52A1\u5206\u7EC4",dataIndex:"group",tip:"\u670D\u52A1\u5206\u7EC4",valueType:"text",copyable:!0},{title:"\u670D\u52A1\u540D\u79F0",dataIndex:"name",tip:"\u670D\u52A1\u540D\u79F0",valueType:"text",copyable:!0},{title:"\u8282\u70B9\u5730\u5740",dataIndex:"address",tip:"\u8282\u70B9\u8BBF\u95EE\u5730\u5740",valueType:"text",hideInSearch:!0,copyable:!0},{title:"\u5728\u7EBF\u72B6\u6001",dataIndex:"online_status",tip:"\u8282\u70B9\u5728\u7EBF\u72B6\u6001",valueEnum:Object.fromEntries(Object.entries((p==null||(f=p.node)===null||f===void 0?void 0:f.online_status)||{}).map(function(o){var n=g()(o,2),t=n[0],r=n[1];return[t,{text:r,color:t=="0"?"green":"red"}]}))},{title:"\u6700\u540E\u5FC3\u8DF3",dataIndex:"last_heart",tip:"\u6700\u540E\u5FC3\u8DF3\u65F6\u95F4\u6233",hideInSearch:!0,render:function(n){return n?(0,J.F)(new Date(n*1e3).toLocaleString("zh-CN")):"-"}},{title:"\u670D\u52A1\u72B6\u6001",dataIndex:"status",tip:"\u670D\u52A1\u72B6\u6001",valueEnum:Object.fromEntries(Object.entries((p==null||(e=p.node)===null||e===void 0?void 0:e.status)||{}).map(function(o){var n=g()(o,2),t=n[0],r=n[1];return[t,{text:r,color:t=="0"?"green":"yellow"}]}))},{title:"\u521B\u5EFA\u65F6\u95F4",valueType:"dateRange",dataIndex:"create_time",tip:"\u521B\u5EFA\u65F6\u95F4",sorter:!0,transform:function(n){var t,r;return{create_time_start:(t=n[0])!==null&&t!==void 0&&t.format?n[0].format("YYYY-MM-DD HH:mm:ss"):n[0],create_time_end:(r=n[1])!==null&&r!==void 0&&r.format?n[1].format("YYYY-MM-DD HH:mm:ss"):n[1]}}},{title:"\u66F4\u65B0\u65F6\u95F4",valueType:"dateRange",dataIndex:"update_time",tip:"\u66F4\u65B0\u65F6\u95F4",sorter:!0,hideInSearch:!0,transform:function(n){var t,r;return{update_time_start:(t=n[0])!==null&&t!==void 0&&t.format?n[0].format("YYYY-MM-DD HH:mm:ss"):n[0],update_time_end:(r=n[1])!==null&&r!==void 0&&r.format?n[1].format("YYYY-MM-DD HH:mm:ss"):n[1]}}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",render:function(n,t){return[(0,i.jsx)(X.Z,{menu:{items:[{key:"edit",label:(0,i.jsx)("a",{onClick:function(){var x;m==null||m.setFieldsValue(t),Z([t==null?void 0:t.address]),(x=b.current)===null||x===void 0||x.show()},children:"\u7F16 \u8F91"})},{key:"delete",label:(0,i.jsx)("a",{onClick:function(){N([t==null?void 0:t.address])},children:"\u5220 \u9664"})}]},trigger:["click"],placement:"bottom",arrow:!0,children:(0,i.jsx)(w.ZP,{size:"small",children:"\u64CD\u4F5C"})},t==null?void 0:t.address)]}}];return(0,i.jsxs)(S.uT,{children:[(0,i.jsx)(S.QV,{ref:d,extraRefreshBtn:!0,title:(0,i.jsx)(S.Dx,{children:"\u670D\u52A1\u8282\u70B9"}),rowKey:"address",columns:ie,defaultPage:1,defaultPageSize:20,rowSelection:{rightExtra:[(0,i.jsx)(w.ZP,{type:"primary",danger:!0,ghost:!0,onClick:function(){var n;N(d==null||(n=d.current)===null||n===void 0?void 0:n.getSelectedRowKeys())},children:"\u6279\u91CF\u5220\u9664"},"delete"),(0,i.jsx)(w.ZP,{type:"primary",ghost:!0,onClick:function(){var n,t;m==null||m.resetFields(),Z(d==null||(n=d.current)===null||n===void 0?void 0:n.getSelectedRowKeys()),(t=b.current)===null||t===void 0||t.show()},children:"\u6279\u91CF\u7F16\u8F91"},"edit")]},request:function(n,t){return(0,K.Y)(n,t,V)},paginationAffix:!0,selectionAffix:!0}),(0,i.jsx)(S.B8,{ref:b,title:(0,i.jsx)(S.Dx,{children:"\u7F16\u8F91\u8282\u70B9"}),onOk:m==null?void 0:m.submit,width:350,modalProps:{confirmLoading:le},children:(0,i.jsx)(k.Z,{form:m,layout:"vertical",onFinish:oe,children:(0,i.jsx)(k.Z.Item,{name:"status",label:"\u670D\u52A1\u72B6\u6001",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u670D\u52A1\u72B6\u6001"}],children:(0,i.jsx)(q.Z,{placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001",options:Object.entries((p==null||(l=p.node)===null||l===void 0?void 0:l.status)||{}).map(function(o){var n=g()(o,2),t=n[0],r=n[1];return{label:r,value:parseInt(t)}})})})})})]})}}}]);

(self.webpackChunk=self.webpackChunk||[]).push([[736],{14731:function(B,L,e){"use strict";e.r(L);var S=e(5574),M=e.n(S),g=e(67294),R=e(44194),h=e(63385),O=e(25336),A=e(90892),o=e(85893),C={0:"green",1:"geekblue",2:"red",3:"warning",4:"blue"};L.default=function(){var s,v=(0,O.ws)(["log"]),c=M()(v,2),I=c[0],j=c[1],D=[{title:"ID",dataIndex:"id",tip:"\u65E5\u5FD7ID",hideInSearch:!0,sorter:!0},{title:"\u64CD\u4F5CIP",dataIndex:"ip",tip:"\u8BF7\u6C42\u6765\u6E90IP\u5730\u5740",valueType:"text",copyable:!0},{title:"\u64CD\u4F5C\u7C7B\u578B",dataIndex:"type",tip:"\u64CD\u4F5C\u4E8B\u4EF6\u7C7B\u578B",valueEnum:Object.fromEntries(Object.entries((I==null||(s=I.log)===null||s===void 0?void 0:s.type)||{}).map(function(b){var d=M()(b,2),m=d[0],y=d[1];return[m,{text:y,color:C[m]}]}))},{title:"\u64CD\u4F5C\u6807\u9898",dataIndex:"title",tip:"\u64CD\u4F5C\u4E8B\u4EF6\u6807\u9898",hideInSearch:!0},{title:"\u64CD\u4F5C\u5185\u5BB9",dataIndex:"content",tip:"\u8BE6\u7EC6\u64CD\u4F5C\u5185\u5BB9",hideInSearch:!0,ellipsis:!0},{title:"\u64CD\u4F5C\u65F6\u95F4",valueType:"dateRange",dataIndex:"create_time",tip:"\u64CD\u4F5C\u65F6\u95F4",sorter:!0,transform:function(d){var m,y;return{create_time_start:(m=d[0])!==null&&m!==void 0&&m.format?d[0].format("YYYY-MM-DD HH:mm:ss"):d[0],create_time_end:(y=d[1])!==null&&y!==void 0&&y.format?d[1].format("YYYY-MM-DD HH:mm:ss"):d[1]}}}];return(0,o.jsx)(R.uT,{loading:j,children:(0,o.jsx)(R.QV,{extraRefreshBtn:!0,title:(0,o.jsx)(R.Dx,{children:"\u64CD\u4F5C\u65E5\u5FD7"}),rowKey:"id",columns:D,request:function(d,m){return(0,h.Y)(d,m,A.Bd)},paginationAffix:!0,selectionAffix:!0})})}},25336:function(B,L,e){"use strict";e.d(L,{ws:function(){return x}});var S=e(97857),M=e.n(S),g=e(64599),R=e.n(g),h=e(5574),O=e.n(h),A=e(15009),o=e.n(A),C=e(99289),s=e.n(C),v=e(12444),c=e.n(v),I=e(72004),j=e.n(I),D=e(9783),b=e.n(D),d=e(41728),m=e(67294),y=function(){function U(){c()(this,U),b()(this,"cache",new Map),b()(this,"CACHE_EXPIRE_TIME",5*60*1e3),b()(this,"pendingRequests",new Map)}return j()(U,[{key:"getEnum",value:function(){var r=s()(o()().mark(function _(u){var i,f,w;return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=this.getFromCache(u),!i){n.next=3;break}return n.abrupt("return",i);case 3:if(!this.pendingRequests.has(u)){n.next=7;break}return n.next=6,this.pendingRequests.get(u);case 6:return n.abrupt("return",n.sent);case 7:return f=this.fetchEnum(u),this.pendingRequests.set(u,f),n.prev=9,n.next=12,f;case 12:return w=n.sent,this.pendingRequests.delete(u),n.abrupt("return",w);case 17:throw n.prev=17,n.t0=n.catch(9),this.pendingRequests.delete(u),n.t0;case 21:case"end":return n.stop()}},_,this,[[9,17]])}));function a(_){return r.apply(this,arguments)}return a}()},{key:"getEnums",value:function(){var r=s()(o()().mark(function _(u){var i=this,f,w;return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return f=u.map(function(k){return i.getEnum(k).then(function(T){return{name:k,data:T}})}),n.next=3,Promise.all(f);case 3:return w=n.sent,n.abrupt("return",w.reduce(function(k,T){var Y=T.name,W=T.data;return k[Y]=W,k},{}));case 5:case"end":return n.stop()}},_)}));function a(_){return r.apply(this,arguments)}return a}()},{key:"getFromCache",value:function(a){var _=this.cache.get(a);return _&&Date.now()-_.timestamp<this.CACHE_EXPIRE_TIME?_.data:(_&&this.cache.delete(a),null)}},{key:"fetchEnum",value:function(){var r=s()(o()().mark(function _(u){var i,f;return o()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,d.U2)("/admin/system/enum?name=".concat(u));case 2:if(i=p.sent,i.code===200){p.next=5;break}return p.abrupt("return",{});case 5:return f=i.data||{},this.cache.set(u,{data:f,timestamp:Date.now()}),p.abrupt("return",f);case 8:case"end":return p.stop()}},_,this)}));function a(_){return r.apply(this,arguments)}return a}()},{key:"isCached",value:function(a){var _=this.cache.get(a);return Date.now()-_.timestamp<this.CACHE_EXPIRE_TIME}},{key:"getCachedData",value:function(a){var _=this.cache.get(a),u=Date.now();if(_){var i=u-_.timestamp,f=i<this.CACHE_EXPIRE_TIME;if(f)return _.data}return null}},{key:"clearCache",value:function(a){a?this.cache.delete(a):this.cache.clear()}},{key:"getCacheInfo",value:function(){var a=this,_=[];return this.cache.forEach(function(u,i){_.push({name:i,timestamp:u.timestamp,expired:Date.now()-u.timestamp>=a.CACHE_EXPIRE_TIME})}),_}}]),U}(),t=new y,Z=function(r){return t.getEnum(r)},K=function(r){return t.getEnums(r)},ee=function(r){var a=useState({}),_=_slicedToArray(a,2),u=_[0],i=_[1],f=useState(!0),w=_slicedToArray(f,2),p=w[0],n=w[1],k=useState(null),T=_slicedToArray(k,2),Y=T[0],W=T[1];return useEffect(function(){if(!r){n(!1);return}var P=!0,X=function(){var z=_asyncToGenerator(_regeneratorRuntime().mark(function F(){var $;return _regeneratorRuntime().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,n(!0),W(null),l.next=5,t.getEnum(r);case 5:$=l.sent,P&&i($),l.next=12;break;case 9:l.prev=9,l.t0=l.catch(0),P&&W(l.t0 instanceof Error?l.t0:new Error("\u83B7\u53D6\u679A\u4E3E\u6570\u636E\u5931\u8D25"));case 12:return l.prev=12,P&&n(!1),l.finish(12);case 15:case"end":return l.stop()}},F,null,[[0,9,12,15]])}));return function(){return z.apply(this,arguments)}}();return X(),function(){P=!1}},[r]),[u,p,Y]},x=function(r){var a=(0,m.useState)({}),_=O()(a,2),u=_[0],i=_[1],f=(0,m.useState)(!0),w=O()(f,2),p=w[0],n=w[1],k=(0,m.useState)(null),T=O()(k,2),Y=T[0],W=T[1];return(0,m.useEffect)(function(){if(!r||r.length===0){n(!1),i({});return}var P=!0,X=function(){var z=s()(o()().mark(function F(){var $,H,l,J,G,N,Q,V;return o()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:E.prev=0,W(null),$=[],H={},l=R()(r);try{for(l.s();!(J=l.n()).done;)G=J.value,N=t.getCachedData(G),N?H[G]=N:$.push(G)}catch(q){l.e(q)}finally{l.f()}if(!($.length>0)){E.next=15;break}return n(!0),Object.keys(H).length>0&&P&&i(H),E.next=11,t.getEnums($);case 11:Q=E.sent,P&&(V=M()(M()({},H),Q),i(V)),E.next=16;break;case 15:P&&i(H);case 16:E.next=21;break;case 18:E.prev=18,E.t0=E.catch(0),P&&W(E.t0 instanceof Error?E.t0:new Error("\u83B7\u53D6\u679A\u4E3E\u6570\u636E\u5931\u8D25"));case 21:return E.prev=21,P&&n(!1),E.finish(21);case 24:case"end":return E.stop()}},F,null,[[0,18,21,24]])}));return function(){return z.apply(this,arguments)}}();return X(),function(){P=!1}},[JSON.stringify(r.sort())]),[u,p,Y]}},63385:function(B,L,e){"use strict";e.d(L,{Y:function(){return o}});var S=e(15009),M=e.n(S),g=e(97857),R=e.n(g),h=e(99289),O=e.n(h);function A(s,v){function c(I){for(var j in I){var D={order_by_field:j};return I[j]=="ascend"?D.order_by_type="asc":D.order_by_type="desc",D}return{}}return s.page=s.current,s.page_size=s.pageSize,delete s.current,delete s.pageSize,Object.assign(s,c(v))}function o(s,v,c){return C.apply(this,arguments)}function C(){return C=O()(M()().mark(function s(v,c,I){var j,D,b,d,m,y,t;return M()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return y=A(v,c),K.next=3,I({body:R()({},y)});case 3:return t=K.sent,K.abrupt("return",{data:(t==null||(j=t.data)===null||j===void 0?void 0:j.list)===void 0||(t==null||(D=t.data)===null||D===void 0?void 0:D.list)===null||(t==null||(b=t.data)===null||b===void 0||(b=b.list)===null||b===void 0?void 0:b.length)<=0?[]:t==null||(d=t.data)===null||d===void 0?void 0:d.list,success:(t==null?void 0:t.code)===200,total:t==null||(m=t.data)===null||m===void 0?void 0:m.total});case 5:case"end":return K.stop()}},s)})),C.apply(this,arguments)}},64599:function(B,L,e){var S=e(96263);function M(g,R){var h=typeof Symbol!="undefined"&&g[Symbol.iterator]||g["@@iterator"];if(!h){if(Array.isArray(g)||(h=S(g))||R&&g&&typeof g.length=="number"){h&&(g=h);var O=0,A=function(){};return{s:A,n:function(){return O>=g.length?{done:!0}:{done:!1,value:g[O++]}},e:function(c){throw c},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,C=!1,s;return{s:function(){h=h.call(g)},n:function(){var c=h.next();return o=c.done,c},e:function(c){C=!0,s=c},f:function(){try{!o&&h.return!=null&&h.return()}finally{if(C)throw s}}}}B.exports=M,B.exports.__esModule=!0,B.exports.default=B.exports}}]);

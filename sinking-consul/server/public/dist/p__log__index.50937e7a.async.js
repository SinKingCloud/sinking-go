"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[736],{14731:function(N,K,e){e.r(K);var U=e(5574),C=e.n(U),Y=e(67294),j=e(55404),W=e(63385),T=e(25336),S=e(90892),E=e(85893),R={0:"green",1:"geekblue",2:"red",3:"warning",4:"blue"};K.default=function(){var i,I=(0,T.ws)(["log"]),M=C()(I,2),p=M[0],w=M[1],v=[{title:"ID",dataIndex:"id",tip:"\u65E5\u5FD7ID",hideInSearch:!0,sorter:!0},{title:"\u64CD\u4F5CIP",dataIndex:"ip",tip:"\u8BF7\u6C42\u6765\u6E90IP\u5730\u5740",valueType:"text",copyable:!0},{title:"\u64CD\u4F5C\u7C7B\u578B",dataIndex:"type",tip:"\u64CD\u4F5C\u4E8B\u4EF6\u7C7B\u578B",valueEnum:Object.fromEntries(Object.entries((p==null||(i=p.log)===null||i===void 0?void 0:i.type)||{}).map(function(g){var o=C()(g,2),d=o[0],D=o[1];return[d,{text:D,color:R[d]}]}))},{title:"\u64CD\u4F5C\u6807\u9898",dataIndex:"title",tip:"\u64CD\u4F5C\u4E8B\u4EF6\u6807\u9898",hideInSearch:!0},{title:"\u64CD\u4F5C\u5185\u5BB9",dataIndex:"content",tip:"\u8BE6\u7EC6\u64CD\u4F5C\u5185\u5BB9",hideInSearch:!0,ellipsis:!0},{title:"\u64CD\u4F5C\u65F6\u95F4",valueType:"dateRange",dataIndex:"create_time",tip:"\u64CD\u4F5C\u65F6\u95F4",sorter:!0,transform:function(o){var d,D;return{create_time_start:(d=o[0])!==null&&d!==void 0&&d.format?o[0].format("YYYY-MM-DD HH:mm:ss"):o[0],create_time_end:(D=o[1])!==null&&D!==void 0&&D.format?o[1].format("YYYY-MM-DD HH:mm:ss"):o[1]}}}];return(0,E.jsx)(j.uT,{loading:w,children:(0,E.jsx)(j.QV,{extraRefreshBtn:!0,title:(0,E.jsx)(j.Dx,{children:"\u64CD\u4F5C\u65E5\u5FD7"}),rowKey:"id",columns:v,request:function(o,d){return(0,W.Y)(o,d,S.Bd)},paginationAffix:!0,selectionAffix:!0})})}},25336:function(N,K,e){e.d(K,{ws:function(){return x}});var U=e(97857),C=e.n(U),Y=e(64599),j=e.n(Y),W=e(5574),T=e.n(W),S=e(15009),E=e.n(S),R=e(99289),i=e.n(R),I=e(12444),M=e.n(I),p=e(72004),w=e.n(p),v=e(9783),g=e.n(v),o=e(41728),d=e(67294),D=function(){function y(){M()(this,y),g()(this,"cache",new Map),g()(this,"CACHE_EXPIRE_TIME",5*60*1e3),g()(this,"pendingRequests",new Map)}return w()(y,[{key:"getEnum",value:function(){var t=i()(E()().mark(function n(r){var u,m,h;return E()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(u=this.getFromCache(r),!u){_.next=3;break}return _.abrupt("return",u);case 3:if(!this.pendingRequests.has(r)){_.next=7;break}return _.next=6,this.pendingRequests.get(r);case 6:return _.abrupt("return",_.sent);case 7:return m=this.fetchEnum(r),this.pendingRequests.set(r,m),_.prev=9,_.next=12,m;case 12:return h=_.sent,this.pendingRequests.delete(r),_.abrupt("return",h);case 17:throw _.prev=17,_.t0=_.catch(9),this.pendingRequests.delete(r),_.t0;case 21:case"end":return _.stop()}},n,this,[[9,17]])}));function a(n){return t.apply(this,arguments)}return a}()},{key:"getEnums",value:function(){var t=i()(E()().mark(function n(r){var u=this,m,h;return E()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return m=r.map(function(O){return u.getEnum(O).then(function(P){return{name:O,data:P}})}),_.next=3,Promise.all(m);case 3:return h=_.sent,_.abrupt("return",h.reduce(function(O,P){var $=P.name,A=P.data;return O[$]=A,O},{}));case 5:case"end":return _.stop()}},n)}));function a(n){return t.apply(this,arguments)}return a}()},{key:"getFromCache",value:function(a){var n=this.cache.get(a);return n&&Date.now()-n.timestamp<this.CACHE_EXPIRE_TIME?n.data:(n&&this.cache.delete(a),null)}},{key:"fetchEnum",value:function(){var t=i()(E()().mark(function n(r){var u,m;return E()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,(0,o.U2)("/admin/system/enum?name=".concat(r));case 2:if(u=f.sent,u.code===200){f.next=5;break}return f.abrupt("return",{});case 5:return m=u.data||{},this.cache.set(r,{data:m,timestamp:Date.now()}),f.abrupt("return",m);case 8:case"end":return f.stop()}},n,this)}));function a(n){return t.apply(this,arguments)}return a}()},{key:"isCached",value:function(a){var n=this.cache.get(a);return Date.now()-n.timestamp<this.CACHE_EXPIRE_TIME}},{key:"getCachedData",value:function(a){var n=this.cache.get(a),r=Date.now();if(n){var u=r-n.timestamp,m=u<this.CACHE_EXPIRE_TIME;if(m)return n.data}return null}},{key:"clearCache",value:function(a){a?this.cache.delete(a):this.cache.clear()}},{key:"getCacheInfo",value:function(){var a=this,n=[];return this.cache.forEach(function(r,u){n.push({name:u,timestamp:r.timestamp,expired:Date.now()-r.timestamp>=a.CACHE_EXPIRE_TIME})}),n}}]),y}(),s=new D,Z=function(t){return s.getEnum(t)},k=function(t){return s.getEnums(t)},ee=function(t){var a=useState({}),n=_slicedToArray(a,2),r=n[0],u=n[1],m=useState(!0),h=_slicedToArray(m,2),f=h[0],_=h[1],O=useState(null),P=_slicedToArray(O,2),$=P[0],A=P[1];return useEffect(function(){if(!t){_(!1);return}var b=!0,G=function(){var X=_asyncToGenerator(_regeneratorRuntime().mark(function H(){var B;return _regeneratorRuntime().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,_(!0),A(null),l.next=5,s.getEnum(t);case 5:B=l.sent,b&&u(B),l.next=12;break;case 9:l.prev=9,l.t0=l.catch(0),b&&A(l.t0 instanceof Error?l.t0:new Error("\u83B7\u53D6\u679A\u4E3E\u6570\u636E\u5931\u8D25"));case 12:return l.prev=12,b&&_(!1),l.finish(12);case 15:case"end":return l.stop()}},H,null,[[0,9,12,15]])}));return function(){return X.apply(this,arguments)}}();return G(),function(){b=!1}},[t]),[r,f,$]},x=function(t){var a=(0,d.useState)({}),n=T()(a,2),r=n[0],u=n[1],m=(0,d.useState)(!0),h=T()(m,2),f=h[0],_=h[1],O=(0,d.useState)(null),P=T()(O,2),$=P[0],A=P[1];return(0,d.useEffect)(function(){if(!t||t.length===0){_(!1),u({});return}var b=!0,G=function(){var X=i()(E()().mark(function H(){var B,L,l,J,F,z,Q,V;return E()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:c.prev=0,A(null),B=[],L={},l=j()(t);try{for(l.s();!(J=l.n()).done;)F=J.value,z=s.getCachedData(F),z?L[F]=z:B.push(F)}catch(q){l.e(q)}finally{l.f()}if(!(B.length>0)){c.next=15;break}return _(!0),Object.keys(L).length>0&&b&&u(L),c.next=11,s.getEnums(B);case 11:Q=c.sent,b&&(V=C()(C()({},L),Q),u(V)),c.next=16;break;case 15:b&&u(L);case 16:c.next=21;break;case 18:c.prev=18,c.t0=c.catch(0),b&&A(c.t0 instanceof Error?c.t0:new Error("\u83B7\u53D6\u679A\u4E3E\u6570\u636E\u5931\u8D25"));case 21:return c.prev=21,b&&_(!1),c.finish(21);case 24:case"end":return c.stop()}},H,null,[[0,18,21,24]])}));return function(){return X.apply(this,arguments)}}();return G(),function(){b=!1}},[JSON.stringify(t.sort())]),[r,f,$]}},63385:function(N,K,e){e.d(K,{Y:function(){return E}});var U=e(15009),C=e.n(U),Y=e(97857),j=e.n(Y),W=e(99289),T=e.n(W);function S(i,I){function M(p){for(var w in p){var v={order_by_field:w};return p[w]=="ascend"?v.order_by_type="asc":v.order_by_type="desc",v}return{}}return i.page=i.current,i.page_size=i.pageSize,delete i.current,delete i.pageSize,Object.assign(i,M(I))}function E(i,I,M){return R.apply(this,arguments)}function R(){return R=T()(C()().mark(function i(I,M,p){var w,v,g,o,d,D,s;return C()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return D=S(I,M),k.next=3,p({body:j()({},D)});case 3:return s=k.sent,k.abrupt("return",{data:(s==null||(w=s.data)===null||w===void 0?void 0:w.list)===void 0||(s==null||(v=s.data)===null||v===void 0?void 0:v.list)===null||(s==null||(g=s.data)===null||g===void 0||(g=g.list)===null||g===void 0?void 0:g.length)<=0?[]:s==null||(o=s.data)===null||o===void 0?void 0:o.list,success:(s==null?void 0:s.code)===200,total:s==null||(d=s.data)===null||d===void 0?void 0:d.total});case 5:case"end":return k.stop()}},i)})),R.apply(this,arguments)}}}]);
